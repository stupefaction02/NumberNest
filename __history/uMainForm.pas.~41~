unit uMainForm;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.StdCtrls, Vcl.ComCtrls, uArrayHelper,
  uHeapSort, uShellSort, uBaseLogger, Unit3, Vcl.ExtCtrls;

type
  TForm1 = class(TForm)
    ShellSortButton: TButton;
    SetLengthTextBox: TEdit;
    Label1: TLabel;
    HeapSortButton: TButton;
    GenerateSetButton: TButton;
    SetPanel: TRichEdit;
    Label2: TLabel;
    Label3: TLabel;
    LogsRichEdit: TRichEdit;
    PaintBox1: TPaintBox;

    procedure GenerateSetButtonClick(Sender: TObject);
    procedure ShellSortButtonClick(Sender: TObject);
    procedure HeapSortButtonClick(Sender: TObject);
    procedure FormCreate(Sender: TObject);
    procedure PaintBox1Paint(Sender: TObject);


  private
    TargetSet: TArray<Integer>;
    ShellSort1: TShellSort;
    HeapSort1: THeapSort;
    Logger: TBaseLogger;
    procedure EnableUI(IsEnable: BOOLEAN);


  public
    { Public declarations }
  end;

var
  Form1: TForm1;

implementation

{$R *.dfm}

procedure TForm1.GenerateSetButtonClick(Sender: TObject);
var
  SetLength: Integer;
begin
  EnableUI(false);

  SetLength := StrToIntDef(SetLengthTextBox.Text, 0);

  TargetSet := nil;
  TargetSet := TArrayHelper.CreateRandom(SetLength);

  Logger.Log( Format('Set of %d elements was generated', [ SetLength ]) );

  Form1.SetPanel.Text := TArrayHelper.ArrayTostring(TargetSet);

  EnableUI(true);
end;

procedure TForm1.HeapSortButtonClick(Sender: TObject);
begin
   EnableUI(false);

   HeapSort1.Sort(TargetSet);

   Form1.SetPanel.Text := TArrayHelper.ArrayTostring(TargetSet);

   EnableUI(true);
end;

procedure TForm1.PaintBox1Paint(Sender: TObject);
var
  X, Y: Integer;
begin


  PaintBox1.Canvas.Brush.Color := clBlack;
  PaintBox1.Canvas.Rectangle(0, PaintBox1.Height, 2, 5);
  //PaintBox1.Canvas.Ellipse(10, 10, 50, 50);
end;

procedure TForm1.ShellSortButtonClick(Sender: TObject);
begin
   EnableUI(false);

   ShellSort1.Sort(TargetSet);

   Form1.SetPanel.Text := TArrayHelper.ArrayTostring(TargetSet);

   EnableUI(true);
end;

procedure TForm1.EnableUI(IsEnable: BOOLEAN);
begin
  SetLengthTextBox.Enabled := IsEnable;
  ShellSortButton.Enabled := IsEnable;
  HeapSortButton.Enabled := IsEnable;
  GenerateSetButton.Enabled := IsEnable;
end;

procedure TForm1.FormCreate(Sender: TObject);
begin
  ShellSort1 := TShellSort.Create;
  HeapSort1 := THeapSort.Create;

  // TODO: Make with factory
  Logger := TBaseLogger.Create('Main');

  Logger.AddProvider( TListBoxLogProvider.Create(LogsRichEdit) );
end;

end.
